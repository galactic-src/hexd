!function(e){var t={};function o(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){"use strict";o.r(t);const n={image:{background:void 0,backgroundCanvas:void 0,output:void 0,outputCanvas:void 0,hiddenImage:void 0,export:void 0,exportCanvas:void 0},control:{xCentre:void 0,yCentre:void 0,edge:void 0,edgeLocked:void 0,fileSelector:void 0,exportButton:void 0},dropzone:void 0};var a=n;const i=e=>Math.round(100*e)/100,r=()=>parseFloat(a.control.edge.value),l=e=>a.control.edge.value=i(e),d=()=>parseFloat(a.control.xCentre.value),c=e=>a.control.xCentre.value=i(e),u=()=>parseFloat(a.control.yCentre.value),s=e=>a.control.yCentre.value=i(e),g=()=>a.control.edgeLocked.checked,m=()=>parseFloat(a.image.output.height),p=()=>parseFloat(a.image.output.width),v=Math.sqrt(3),h=e=>2*e,f=e=>e*v,C=(e,t,o,n,a)=>({x:y(e,o,n),y:b(t,o,a)}),y=(e,t,o)=>{const n=f(t);return e+n/2>o?o-n/2:e-n/2<0?n/2:e},b=(e,t,o)=>{const n=h(t);return e+n/2>o?o-n/2:e-n/2<0?n/2:e},x=e=>{e.globalAlpha=1,e.globalCompositeOperation="source-over",e.lineWidth=3,e.strokeStyle="#FFFFFF"},E=()=>{const e=a.image.outputCanvas;0===r()?w(e):(T(e),I(e))},T=e=>{x(e),e.drawImage(a.image.hiddenImage,0,0)},w=e=>{x(e),e.globalCompositeOperation="destination-out",e.clearRect(0,0,e.canvas.width,e.canvas.height)},I=e=>{const t=r(),o=d(),n=u(),a=f(t),i=h(t),l=n-i/2,c=n+i/2,s=o+a/2,g=o-a/2;x(e),e.globalCompositeOperation="destination-out";const m=Math.max(l-1,0),p=Math.min(c+1,e.canvas.height),v=p-m,C=Math.max(g-1,0),y=Math.min(s+1,e.canvas.width);l>0&&e.fillRect(0,0,e.canvas.width,l),c<e.canvas.height&&e.fillRect(0,c,e.canvas.width,e.canvas.height-c),g>0&&e.fillRect(0,m,g,v),s<e.canvas.width&&e.fillRect(s,m,e.canvas.width-s,v),e.beginPath(),e.moveTo(C,m),e.lineTo(C,l+.5*t+1),e.lineTo(g,l+.5*t),e.lineTo(o,l),e.lineTo(s,l+.5*t),e.lineTo(y,l+.5*t+1),e.lineTo(y,m),e.closePath(),e.fill(),e.beginPath(),e.moveTo(C,p),e.lineTo(C,c-.5*t-1),e.lineTo(g,c-.5*t),e.lineTo(o,c),e.lineTo(s,c-.5*t),e.lineTo(y,c-.5*t-1),e.lineTo(y,p),e.closePath(),e.fill()},L=(e,t,o)=>{const n=r(),a=m(),i=p(),l=f(n)/2,d=h(n)/2,c=d/2,{x:u,y:s}=C(t,o,n,i,a);x(e),e.beginPath(),e.moveTo(u-l,s-c),e.lineTo(u-l,s+c),e.lineTo(u,s+d),e.lineTo(u+l,s+c),e.lineTo(u+l,s-c),e.lineTo(u,s-d),e.closePath(),e.stroke()};var k={scaleCentreX:0,scaleCentreY:0};const B=e=>{const t=p(),o=r(),n=f(o),a=g();console.log(e),console.log(t),e<2?e=2:e>t-2&&(e=t-2),console.log(e),k.scaleCentreX=e;const i=e+n/2;e-n/2<0?a?c(n/2):l(e/(v/2)):i>t&&(a?c(t-n/2):l((t-e)/(v/2))),E()},F=e=>{const t=m(),o=r(),n=h(o),a=g();e<2?e=2:e>t-2&&(e=t-2),k.scaleCentreY=e;const i=e+n/2;e-n/2<0?a?s(n/2):l(e):i>t&&(a?s(t-n/2):l(t-e)),E(),k.scaleCentreY=u()},P=e=>{const t=m(),o=p();let n=e;h(e)>t&&(n=t/2),f(n)>o&&(n=o/v),n!==e&&l(n);const a=d(),i=f(n);a+i/2>o?c(o-i/2):a-i/2<0&&c(i/2);const r=u(),g=h(n);r+g/2>t?s(t-g/2):r-g/2<0&&s(g/2),E()},M=e=>{void 0!==a.image.hiddenImage&&document.body.removeChild(a.image.hiddenImage);const t=document.createElement("img");t.id="hiddenImage",t.origin="anonymous",t.src=URL.createObjectURL(e),t.style="position:absolute; top: -9999px; left: -9999px;",t.onload=function(){n.image.hiddenImage=document.getElementById("hiddenImage"),a.image.output.width=a.image.background.width=this.naturalWidth,a.image.output.height=a.image.background.height=this.naturalHeight,x(a.image.backgroundCanvas),a.image.backgroundCanvas.globalAlpha=.3,a.image.backgroundCanvas.drawImage(a.image.hiddenImage,0,0),O(a.image.outputCanvas),E()},document.body.appendChild(t)},O=e=>{const t=a.image.output.width/v,o=a.image.output.height/2,n=Math.min(t,o,80),i=a.image.output.width/2,r=a.image.output.height/2;k.scaleCentreX=i,k.scaleCentreY=r,l(n),c(i),s(r)},z=()=>{window.addEventListener("dragenter",(function(e){a.dropzone.style.visibility="visible"})),a.dropzone.addEventListener("dragleave",e=>{a.dropzone.style.visibility="hidden"}),a.dropzone.addEventListener("dragenter",e=>{e.dataTransfer.dropEffect="move",e.preventDefault()}),a.dropzone.addEventListener("dragover",e=>{e.dataTransfer.dropEffect="move",e.preventDefault()}),a.dropzone.addEventListener("drop",e=>{var t;e.preventDefault(),e.stopPropagation(),a.dropzone.style.visibility="hidden",t=e.dataTransfer.files[0],M(t)}),a.control.fileSelector.addEventListener("change",e=>{var t;void 0!==(t=e.target.files[0])&&M(t)})},R=()=>{const e=r();if(0===e)return void alert("hex too small");const t=f(e),o=h(e);a.image.export.width=t,a.image.export.height=o;const n=d()-t/2,i=u()-o/2;a.image.exportCanvas.drawImage(a.image.output,n,i,t,o,0,0,t,o),a.control.exportButton.href=a.image.export.toDataURL("image/png")};window.onload=()=>{(()=>{const e=document.getElementById("background");n.image.background=e,n.image.backgroundCanvas=e.getContext("2d");const t=document.getElementById("output");n.image.output=t,n.image.outputCanvas=t.getContext("2d"),n.control.xCentre=document.getElementById("x"),n.control.yCentre=document.getElementById("y"),n.control.edge=document.getElementById("edge"),n.control.fileSelector=document.getElementById("fileSelector"),n.control.exportButton=document.getElementById("export"),n.control.edgeLocked=document.getElementById("edgeLocked"),n.dropzone=document.getElementById("dropzone");const o=document.createElement("canvas");n.image.export=o,n.image.exportCanvas=o.getContext("2d")})(),a.image.output.addEventListener("mousemove",({clientX:e,clientY:t})=>{const{left:o,top:n}=a.image.output.getBoundingClientRect(),i=e-o,r=t-n;E(),L(a.image.outputCanvas,i,r)}),a.image.output.addEventListener("click",({clientX:e,clientY:t})=>{const{left:o,top:n}=a.image.output.getBoundingClientRect(),i=e-o,l=t-n;k.scaleCentreX=i,k.scaleCentreY=l;const{x:d,y:u}=C(i,l,r(),p(),m());c(d),s(u),E(),L(a.image.outputCanvas,i,l)}),a.image.output.addEventListener("mouseleave",()=>{E()}),a.image.output.addEventListener("wheel",e=>{if(e.preventDefault(),g())return;let t=r()+.5*e.deltaY;t<0&&(t=0),c(k.scaleCentreX),B(k.scaleCentreX),s(k.scaleCentreY),F(k.scaleCentreY),l(t),P(t)}),a.control.xCentre.addEventListener("change",e=>B(parseFloat(a.control.xCentre.value))),a.control.yCentre.addEventListener("change",e=>F(parseFloat(a.control.yCentre.value))),a.control.edge.addEventListener("change",e=>P(parseFloat(a.control.edge.value))),z(),a.control.exportButton.addEventListener("click",e=>R())}}]);
//# sourceMappingURL=bundle.js.map