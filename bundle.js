!function(e){var t={};function o(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){"use strict";o.r(t);const n={image:{background:void 0,backgroundCanvas:void 0,output:void 0,outputCanvas:void 0,hiddenImage:void 0,export:void 0,exportCanvas:void 0},control:{xCentre:void 0,yCentre:void 0,edge:void 0,edgeLocked:void 0,fileSelector:void 0,exportButton:void 0},dropzone:void 0};var a=n;const r=e=>Math.round(100*e)/100,i=()=>parseFloat(a.control.edge.value),d=e=>a.control.edge.value=r(e),l=()=>parseFloat(a.control.xCentre.value),c=e=>a.control.xCentre.value=r(e),u=()=>parseFloat(a.control.yCentre.value),s=e=>a.control.yCentre.value=r(e),g=()=>a.control.edgeLocked.checked,m=()=>parseFloat(a.image.output.height),p=()=>parseFloat(a.image.output.width),v=Math.sqrt(3),h=e=>2*e,f=e=>e*v,C=(e,t,o,n,a)=>({x:y(e,o,n),y:b(t,o,a)}),y=(e,t,o)=>{const n=f(t);return e+n/2>o?o-n/2:e-n/2<0?n/2:e},b=(e,t,o)=>{const n=h(t);return e+n/2>o?o-n/2:e-n/2<0?n/2:e},x=e=>{e.globalAlpha=1,e.globalCompositeOperation="source-over",e.lineWidth=3,e.strokeStyle="#FFFFFF"},E=()=>{const e=a.image.outputCanvas;0===i()?L(e):(T(e),w(e))},T=e=>{x(e),e.drawImage(a.image.hiddenImage,0,0)},L=e=>{x(e),e.globalCompositeOperation="destination-out",e.clearRect(0,0,e.canvas.width,e.canvas.height)},w=e=>{const t=i(),o=l(),n=u(),a=f(t),r=h(t),d=n-r/2,c=n+r/2,s=o+a/2,g=o-a/2;x(e),e.globalCompositeOperation="destination-out";const m=Math.max(d-1,0),p=Math.min(c+1,e.canvas.height),v=p-m,C=Math.max(g-1,0),y=Math.min(s+1,e.canvas.width);d>0&&e.fillRect(0,0,e.canvas.width,d),c<e.canvas.height&&e.fillRect(0,c,e.canvas.width,e.canvas.height-c),g>0&&e.fillRect(0,m,g,v),s<e.canvas.width&&e.fillRect(s,m,e.canvas.width-s,v),e.beginPath(),e.moveTo(C,m),e.lineTo(C,d+.5*t+1),e.lineTo(g,d+.5*t),e.lineTo(o,d),e.lineTo(s,d+.5*t),e.lineTo(y,d+.5*t+1),e.lineTo(y,m),e.closePath(),e.fill(),e.beginPath(),e.moveTo(C,p),e.lineTo(C,c-.5*t-1),e.lineTo(g,c-.5*t),e.lineTo(o,c),e.lineTo(s,c-.5*t),e.lineTo(y,c-.5*t-1),e.lineTo(y,p),e.closePath(),e.fill()};var I={scaleCentreX:0,scaleCentreY:0,outputDrag:!1};const k=({clientX:e,clientY:t},o)=>{const{left:n,top:r}=a.image.output.getBoundingClientRect(),d=e-n,l=t-r;if(o){I.scaleCentreX=d,I.scaleCentreY=l;const{x:e,y:t}=C(d,l,i(),p(),m());c(e),s(t)}E(),((e,t,o)=>{const n=i(),a=m(),r=p(),d=f(n)/2,l=h(n)/2,c=l/2,{x:u,y:s}=C(t,o,n,r,a);x(e),e.beginPath(),e.moveTo(u-d,s-c),e.lineTo(u-d,s+c),e.lineTo(u,s+l),e.lineTo(u+d,s+c),e.lineTo(u+d,s-c),e.lineTo(u,s-l),e.closePath(),e.stroke()})(a.image.outputCanvas,d,l)},B=e=>{const t=p(),o=i(),n=f(o),a=g();e<2?e=2:e>t-2&&(e=t-2),I.scaleCentreX=e;const r=e+n/2;e-n/2<0?a?c(n/2):d(e/(v/2)):r>t&&(a?c(t-n/2):d((t-e)/(v/2))),E()},F=e=>{const t=m(),o=i(),n=h(o),a=g();e<2?e=2:e>t-2&&(e=t-2),I.scaleCentreY=e;const r=e+n/2;e-n/2<0?a?s(n/2):d(e):r>t&&(a?s(t-n/2):d(t-e)),E(),I.scaleCentreY=u()},P=e=>{const t=m(),o=p();let n=e;h(e)>t&&(n=t/2),f(n)>o&&(n=o/v),n!==e&&d(n);const a=l(),r=f(n);a+r/2>o?c(o-r/2):a-r/2<0&&c(r/2);const i=u(),g=h(n);i+g/2>t?s(t-g/2):i-g/2<0&&s(g/2),E()},M=e=>{void 0!==a.image.hiddenImage&&document.body.removeChild(a.image.hiddenImage);const t=document.createElement("img");t.id="hiddenImage",t.origin="anonymous",t.src=URL.createObjectURL(e),t.style="position:absolute; top: -9999px; left: -9999px;",t.onload=function(){n.image.hiddenImage=document.getElementById("hiddenImage"),a.image.output.width=a.image.background.width=this.naturalWidth,a.image.output.height=a.image.background.height=this.naturalHeight,x(a.image.backgroundCanvas),a.image.backgroundCanvas.globalAlpha=.3,a.image.backgroundCanvas.drawImage(a.image.hiddenImage,0,0),O(a.image.outputCanvas),E()},document.body.appendChild(t)},O=e=>{const t=a.image.output.width/v,o=a.image.output.height/2,n=Math.min(t,o,80),r=a.image.output.width/2,i=a.image.output.height/2;I.scaleCentreX=r,I.scaleCentreY=i,d(n),c(r),s(i)},z=()=>{window.addEventListener("dragenter",(function(e){a.dropzone.style.visibility="visible"})),a.dropzone.addEventListener("dragleave",e=>{a.dropzone.style.visibility="hidden"}),a.dropzone.addEventListener("dragenter",e=>{e.dataTransfer.dropEffect="move",e.preventDefault()}),a.dropzone.addEventListener("dragover",e=>{e.dataTransfer.dropEffect="move",e.preventDefault()}),a.dropzone.addEventListener("drop",e=>{var t;e.preventDefault(),e.stopPropagation(),a.dropzone.style.visibility="hidden",t=e.dataTransfer.files[0],M(t)}),a.control.fileSelector.addEventListener("change",e=>{var t;void 0!==(t=e.target.files[0])&&M(t)})},D=()=>{const e=i();if(0===e)return void alert("hex too small");const t=f(e),o=h(e);a.image.export.width=t,a.image.export.height=o;const n=l()-t/2,r=u()-o/2;a.image.exportCanvas.drawImage(a.image.output,n,r,t,o,0,0,t,o),a.control.exportButton.href=a.image.export.toDataURL("image/png")};window.onload=()=>{(()=>{const e=document.getElementById("background");n.image.background=e,n.image.backgroundCanvas=e.getContext("2d");const t=document.getElementById("output");n.image.output=t,n.image.outputCanvas=t.getContext("2d"),n.control.xCentre=document.getElementById("x"),n.control.yCentre=document.getElementById("y"),n.control.edge=document.getElementById("edge"),n.control.fileSelector=document.getElementById("fileSelector"),n.control.exportButton=document.getElementById("export"),n.control.edgeLocked=document.getElementById("edgeLocked"),n.dropzone=document.getElementById("dropzone");const o=document.createElement("canvas");n.image.export=o,n.image.exportCanvas=o.getContext("2d")})(),document.body.addEventListener("mouseup",e=>I.outputDrag=!1),document.body.addEventListener("mouseleave",e=>I.outputDrag=!1),a.image.output.addEventListener("mousedown",e=>I.outputDrag=!0),a.image.output.addEventListener("mousemove",e=>k(e,I.outputDrag)),a.image.output.addEventListener("click",e=>k(e,!0)),a.image.output.addEventListener("mouseleave",()=>{E()}),a.image.output.addEventListener("wheel",e=>{if(e.preventDefault(),g())return;let t=i()+.5*e.deltaY;t<0&&(t=0),c(I.scaleCentreX),B(I.scaleCentreX),s(I.scaleCentreY),F(I.scaleCentreY),d(t),P(t)}),a.control.xCentre.addEventListener("change",e=>B(parseFloat(a.control.xCentre.value))),a.control.yCentre.addEventListener("change",e=>F(parseFloat(a.control.yCentre.value))),a.control.edge.addEventListener("change",e=>P(parseFloat(a.control.edge.value))),z(),a.control.exportButton.addEventListener("click",e=>D())}}]);
//# sourceMappingURL=bundle.js.map