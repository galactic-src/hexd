!function(e){var t={};function n(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(o,a,function(t){return e[t]}.bind(null,a));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);const o=Math.sqrt(3),a=e=>2*e,c=e=>e*o,r={canvas:{background:void 0,backgroundCanvas:void 0,output:void 0,outputCanvas:void 0},control:{xCentre:void 0,yCentre:void 0,edge:void 0,fileSelector:void 0,exportButton:void 0}};var l=r;const i=e=>Math.round(100*e)/100,s=()=>parseFloat(document.getElementById("edge").value),d=e=>document.getElementById("edge").value=i(e),u=()=>parseFloat(l.control.xCentre.value),v=e=>l.control.xCentre.value=i(e),g=()=>parseFloat(l.control.yCentre.value),p=e=>l.control.yCentre.value=i(e),f=()=>document.getElementById("edgeLocked").checked,h=e=>{e.globalAlpha=1,e.globalCompositeOperation="source-over",e.lineWidth=3,e.strokeStyle="#FFFFFF"};var m={scaleCentreX:0,scaleCentreY:0};const y=()=>document.getElementById("hiddenImage"),C=()=>parseFloat(l.canvas.output.height),b=()=>parseFloat(l.canvas.output.width);function E(e){const t=b(),n=s(),a=c(n),r=f();e<0?e=0:e>t&&(e=t),m.scaleCentreX=e;const l=e+a/2;e-a/2<0?r?v(a/2):d(e/(o/2)):l>t&&(r?v(t-a/2):d((t-e)/(o/2))),w()}function x(e){const t=C(),n=s(),o=a(n),c=f();e<0?e=0:e>t&&(e=t),m.scaleCentreY=e;const r=e+o/2;e-o/2<0?c?p(o/2):d(e):r>t&&(c?p(t-o/2):d(t-e)),w(),m.scaleCentreY=g()}function T(e){const t=C(),n=b();let r=e;a(e)>t&&(r=t/2),c(r)>n&&(r=n/o),r!==e&&d(r);const l=u(),i=c(r);l+i/2>n?v(n-i/2):l-i/2<0&&v(i/2);const s=g(),f=a(r);s+f/2>t?p(t-f/2):s-f/2<0&&p(f/2),w()}function w(){const e=l.canvas.outputCanvas;0===s()?function(e){h(e),e.globalCompositeOperation="destination-out",e.clearRect(0,0,e.canvas.width,e.canvas.height)}(e):(function(e){h(e),e.drawImage(y(),0,0)}(e),function(e){const t=s(),n=u(),o=g(),r=c(t),l=a(t),i=o-l/2,d=o+l/2,v=n+r/2,p=n-r/2;h(e),e.globalCompositeOperation="destination-out";const f=Math.max(i-1,0),m=Math.min(d+1,e.canvas.height),y=m-f,C=Math.max(p-1,0),b=Math.min(v+1,e.canvas.width);i>0&&e.fillRect(0,0,e.canvas.width,i);d<e.canvas.height&&e.fillRect(0,d,e.canvas.width,e.canvas.height-d);p>0&&e.fillRect(0,f,p,y);v<e.canvas.width&&e.fillRect(v,f,e.canvas.width-v,y);e.beginPath(),e.moveTo(C,f),e.lineTo(C,i+.5*t+1),e.lineTo(p,i+.5*t),e.lineTo(n,i),e.lineTo(v,i+.5*t),e.lineTo(b,i+.5*t+1),e.lineTo(b,f),e.closePath(),e.fill(),e.beginPath(),e.moveTo(C,m),e.lineTo(C,d-.5*t-1),e.lineTo(p,d-.5*t),e.lineTo(n,d),e.lineTo(v,d-.5*t),e.lineTo(b,d-.5*t-1),e.lineTo(b,m),e.closePath(),e.fill()}(e))}function I(e){const t=y();null!==t&&document.body.removeChild(t);const n=document.createElement("img");n.id="hiddenImage",n.origin="anonymous",n.src=URL.createObjectURL(e),n.style="position:absolute; top: -9999px; left: -9999px;",n.onload=function(){const e=l.canvas.outputCanvas,t=l.canvas.backgroundCanvas;e.canvas.width=t.canvas.width=this.naturalWidth,e.canvas.height=t.canvas.height=this.naturalHeight,h(t),t.globalAlpha=.3,t.drawImage(y(),0,0),function(e){const t=e.canvas.width/o,n=e.canvas.height/2,a=Math.min(t,n,80),c=e.canvas.width/2,r=e.canvas.height/2;m.scaleCentreX=c,m.scaleCentreY=r,d(a),v(c),p(r)}(e),w()},document.body.appendChild(n)}window.onload=()=>{(()=>{const e=document.getElementById("background");r.canvas.background=e,r.canvas.backgroundCanvas=e.getContext("2d")})(),(()=>{const e=document.getElementById("output");r.canvas.output=e,r.canvas.outputCanvas=e.getContext("2d")})(),r.control.xCentre=document.getElementById("x"),r.control.yCentre=document.getElementById("y"),r.control.edge=document.getElementById("edge"),r.control.fileSelector=document.getElementById("fileSelector"),r.control.exportButton=document.getElementById("export"),l.canvas.output.addEventListener("mousemove",({clientX:e,clientY:t})=>{const{left:n,top:o}=l.canvas.output.getBoundingClientRect(),a=e-n,c=t-o;w(),k(l.canvas.outputCanvas,a,c)}),l.canvas.output.addEventListener("click",({clientX:e,clientY:t})=>{const{left:n,top:o}=l.canvas.output.getBoundingClientRect(),a=e-n,c=t-o;m.scaleCentreX=a,m.scaleCentreY=c;const{x:r,y:i}=B(a,c,s(),b(),C());v(r),p(i),w(),k(l.canvas.outputCanvas,a,c)}),l.canvas.output.addEventListener("mouseleave",()=>{w()}),l.canvas.output.addEventListener("wheel",e=>{if(e.preventDefault(),f())return;let t=s()+.5*e.deltaY;t<0&&(t=0),v(m.scaleCentreX),E(m.scaleCentreX),p(m.scaleCentreY),x(m.scaleCentreY),d(t),T(t)});const e=document.getElementById("dropzone");window.addEventListener("dragenter",(function(t){e.style.visibility="visible"}));e.addEventListener("dragenter",e=>{e.dataTransfer.dropEffect="move",e.preventDefault()}),e.addEventListener("dragover",e=>{e.dataTransfer.dropEffect="move",e.preventDefault()}),e.addEventListener("drop",t=>{t.preventDefault(),t.stopPropagation(),e.style.visibility="hidden",I(t.dataTransfer.files[0])}),e.addEventListener("dragleave",t=>{e.style.visibility="hidden"}),l.control.xCentre.addEventListener("change",e=>E(parseFloat(l.control.xCentre.value))),l.control.yCentre.addEventListener("change",e=>x(parseFloat(l.control.yCentre.value))),l.control.edge.addEventListener("change",e=>T(parseFloat(l.control.edge.value))),l.control.fileSelector.addEventListener("change",e=>function(e){if(void 0===e)return;I(e)}(e.target.files[0]));const t=document.getElementById("export");t.addEventListener("click",e=>function(e){const t=s();if(0===t)return void alert("hex too small");const n=c(t),o=a(t),r=document.createElement("canvas");r.width=n,r.height=o;const l=u(),i=g(),d=l-n/2,v=i-o/2;r.getContext("2d").drawImage(document.getElementById("output"),d,v,n,o,0,0,n,o),e.href=r.toDataURL("image/png")}(t))};const B=(e,t,n,o,a)=>({x:L(e,n,o),y:F(t,n,a)}),L=(e,t,n)=>{const o=c(t);return e+o/2>n?n-o/2:e-o/2<0?o/2:e},F=(e,t,n)=>{const o=a(t);return e+o/2>n?n-o/2:e-o/2<0?o/2:e};function k(e,t,n){const o=s(),r=C(),l=b(),i=c(o)/2,d=a(o)/2,u=d/2,{x:v,y:g}=B(t,n,o,l,r);h(e),e.beginPath(),e.moveTo(v-i,g-u),e.lineTo(v-i,g+u),e.lineTo(v,g+d),e.lineTo(v+i,g+u),e.lineTo(v+i,g-u),e.lineTo(v,g-d),e.closePath(),e.stroke()}}]);
//# sourceMappingURL=bundle.js.map