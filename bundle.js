!function(e){var t={};function n(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(o,a,function(t){return e[t]}.bind(null,a));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);const o=Math.sqrt(3),a=e=>2*e,i=e=>e*o,r=(e,t,n,o,a)=>({x:d(e,n,o),y:l(t,n,a)}),d=(e,t,n)=>{const o=i(t);return e+o/2>n?n-o/2:e-o/2<0?o/2:e},l=(e,t,n)=>{const o=a(t);return e+o/2>n?n-o/2:e-o/2<0?o/2:e},c={image:{background:void 0,backgroundCanvas:void 0,output:void 0,outputCanvas:void 0,hiddenImage:void 0,export:void 0,exportCanvas:void 0},control:{xCentre:void 0,yCentre:void 0,edge:void 0,edgeLocked:void 0,fileSelector:void 0,exportButton:void 0},dropzone:void 0};var u=c;const s=e=>Math.round(100*e)/100,g=()=>parseFloat(u.control.edge.value),m=e=>u.control.edge.value=s(e),p=()=>parseFloat(u.control.xCentre.value),v=e=>u.control.xCentre.value=s(e),h=()=>parseFloat(u.control.yCentre.value),f=e=>u.control.yCentre.value=s(e),C=()=>u.control.edgeLocked.checked,y=()=>parseFloat(u.image.output.height),b=()=>parseFloat(u.image.output.width),x=e=>{e.globalAlpha=1,e.globalCompositeOperation="source-over",e.lineWidth=3,e.strokeStyle="#FFFFFF"},E=()=>{const e=u.image.outputCanvas;0===g()?w(e):(T(e),I(e))},T=e=>{x(e),e.drawImage(u.image.hiddenImage,0,0)},w=e=>{x(e),e.globalCompositeOperation="destination-out",e.clearRect(0,0,e.canvas.width,e.canvas.height)},I=e=>{const t=g(),n=p(),o=h(),r=i(t),d=a(t),l=o-d/2,c=o+d/2,u=n+r/2,s=n-r/2;x(e),e.globalCompositeOperation="destination-out";const m=Math.max(l-1,0),v=Math.min(c+1,e.canvas.height),f=v-m,C=Math.max(s-1,0),y=Math.min(u+1,e.canvas.width);l>0&&e.fillRect(0,0,e.canvas.width,l),c<e.canvas.height&&e.fillRect(0,c,e.canvas.width,e.canvas.height-c),s>0&&e.fillRect(0,m,s,f),u<e.canvas.width&&e.fillRect(u,m,e.canvas.width-u,f),e.beginPath(),e.moveTo(C,m),e.lineTo(C,l+.5*t+1),e.lineTo(s,l+.5*t),e.lineTo(n,l),e.lineTo(u,l+.5*t),e.lineTo(y,l+.5*t+1),e.lineTo(y,m),e.closePath(),e.fill(),e.beginPath(),e.moveTo(C,v),e.lineTo(C,c-.5*t-1),e.lineTo(s,c-.5*t),e.lineTo(n,c),e.lineTo(u,c-.5*t),e.lineTo(y,c-.5*t-1),e.lineTo(y,v),e.closePath(),e.fill()},L=(e,t,n)=>{const o=g(),d=y(),l=b(),c=i(o)/2,u=a(o)/2,s=u/2,{x:m,y:p}=r(t,n,o,l,d);x(e),e.beginPath(),e.moveTo(m-c,p-s),e.lineTo(m-c,p+s),e.lineTo(m,p+u),e.lineTo(m+c,p+s),e.lineTo(m+c,p-s),e.lineTo(m,p-u),e.closePath(),e.stroke()};var k={scaleCentreX:0,scaleCentreY:0};const B=e=>{void 0!==u.image.hiddenImage&&document.body.removeChild(u.image.hiddenImage);const t=document.createElement("img");t.id="hiddenImage",t.origin="anonymous",t.src=URL.createObjectURL(e),t.style="position:absolute; top: -9999px; left: -9999px;",t.onload=function(){c.image.hiddenImage=document.getElementById("hiddenImage"),u.image.output.width=u.image.background.width=this.naturalWidth,u.image.output.height=u.image.background.height=this.naturalHeight,x(u.image.backgroundCanvas),u.image.backgroundCanvas.globalAlpha=.3,u.image.backgroundCanvas.drawImage(u.image.hiddenImage,0,0),F(u.image.outputCanvas),E()},document.body.appendChild(t)},F=e=>{const t=u.image.output.width/o,n=u.image.output.height/2,a=Math.min(t,n,80),i=u.image.output.width/2,r=u.image.output.height/2;k.scaleCentreX=i,k.scaleCentreY=r,m(a),v(i),f(r)};function P(e){const t=b(),n=g(),a=i(n),r=C();e<0?e=0:e>t&&(e=t),k.scaleCentreX=e;const d=e+a/2;e-a/2<0?r?v(a/2):m(e/(o/2)):d>t&&(r?v(t-a/2):m((t-e)/(o/2))),E()}function M(e){const t=y(),n=g(),o=a(n),i=C();e<0?e=0:e>t&&(e=t),k.scaleCentreY=e;const r=e+o/2;e-o/2<0?i?f(o/2):m(e):r>t&&(i?f(t-o/2):m(t-e)),E(),k.scaleCentreY=h()}function O(e){const t=y(),n=b();let r=e;a(e)>t&&(r=t/2),i(r)>n&&(r=n/o),r!==e&&m(r);const d=p(),l=i(r);d+l/2>n?v(n-l/2):d-l/2<0&&v(l/2);const c=h(),u=a(r);c+u/2>t?f(t-u/2):c-u/2<0&&f(u/2),E()}window.onload=()=>{(()=>{const e=document.getElementById("background");c.image.background=e,c.image.backgroundCanvas=e.getContext("2d")})(),(()=>{const e=document.getElementById("output");c.image.output=e,c.image.outputCanvas=e.getContext("2d")})(),c.control.xCentre=document.getElementById("x"),c.control.yCentre=document.getElementById("y"),c.control.edge=document.getElementById("edge"),c.control.fileSelector=document.getElementById("fileSelector"),c.control.exportButton=document.getElementById("export"),c.control.edgeLocked=document.getElementById("edgeLocked"),c.dropzone=document.getElementById("dropzone"),(()=>{const e=document.createElement("canvas");c.image.export=e,c.image.exportCanvas=e.getContext("2d")})(),u.image.output.addEventListener("mousemove",({clientX:e,clientY:t})=>{const{left:n,top:o}=u.image.output.getBoundingClientRect(),a=e-n,i=t-o;E(),L(u.image.outputCanvas,a,i)}),u.image.output.addEventListener("click",({clientX:e,clientY:t})=>{const{left:n,top:o}=u.image.output.getBoundingClientRect(),a=e-n,i=t-o;k.scaleCentreX=a,k.scaleCentreY=i;const{x:d,y:l}=r(a,i,g(),b(),y());v(d),f(l),E(),L(u.image.outputCanvas,a,i)}),u.image.output.addEventListener("mouseleave",()=>{E()}),u.image.output.addEventListener("wheel",e=>{if(e.preventDefault(),C())return;let t=g()+.5*e.deltaY;t<0&&(t=0),v(k.scaleCentreX),P(k.scaleCentreX),f(k.scaleCentreY),M(k.scaleCentreY),m(t),O(t)}),window.addEventListener("dragenter",(function(e){u.dropzone.style.visibility="visible"}));u.dropzone.addEventListener("dragenter",e=>{e.dataTransfer.dropEffect="move",e.preventDefault()}),u.dropzone.addEventListener("dragover",e=>{e.dataTransfer.dropEffect="move",e.preventDefault()}),u.dropzone.addEventListener("drop",e=>{var t;e.preventDefault(),e.stopPropagation(),u.dropzone.style.visibility="hidden",t=e.dataTransfer.files[0],B(t)}),u.dropzone.addEventListener("dragleave",e=>{u.dropzone.style.visibility="hidden"}),u.control.xCentre.addEventListener("change",e=>P(parseFloat(u.control.xCentre.value))),u.control.yCentre.addEventListener("change",e=>M(parseFloat(u.control.yCentre.value))),u.control.edge.addEventListener("change",e=>O(parseFloat(u.control.edge.value))),u.control.fileSelector.addEventListener("change",e=>{var t;void 0!==(t=e.target.files[0])&&B(t)}),u.control.exportButton.addEventListener("click",e=>function(e){const t=g();if(0===t)return void alert("hex too small");const n=i(t),o=a(t);u.image.export.width=n,u.image.export.height=o;const r=p(),d=h(),l=r-n/2,c=d-o/2;u.image.exportCanvas.drawImage(u.image.output,l,c,n,o,0,0,n,o),e.href=u.image.export.toDataURL("image/png")}(u.control.exportButton))}}]);
//# sourceMappingURL=bundle.js.map