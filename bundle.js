!function(e){var t={};function n(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(o,a,function(t){return e[t]}.bind(null,a));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);const o=Math.sqrt(3),a=e=>2*e,i=e=>e*o,r={image:{background:void 0,backgroundCanvas:void 0,output:void 0,outputCanvas:void 0,hiddenImage:void 0},control:{xCentre:void 0,yCentre:void 0,edge:void 0,edgeLocked:void 0,fileSelector:void 0,exportButton:void 0}};var l=r;const c=e=>Math.round(100*e)/100,d=()=>parseFloat(l.control.edge.value),s=e=>l.control.edge.value=c(e),u=()=>parseFloat(l.control.xCentre.value),g=e=>l.control.xCentre.value=c(e),v=()=>parseFloat(l.control.yCentre.value),m=e=>l.control.yCentre.value=c(e),p=()=>l.control.edgeLocked.checked,h=e=>{e.globalAlpha=1,e.globalCompositeOperation="source-over",e.lineWidth=3,e.strokeStyle="#FFFFFF"};var f={scaleCentreX:0,scaleCentreY:0};const y=()=>parseFloat(l.image.output.height),C=()=>parseFloat(l.image.output.width);function b(e){const t=C(),n=d(),a=i(n),r=p();e<0?e=0:e>t&&(e=t),f.scaleCentreX=e;const l=e+a/2;e-a/2<0?r?g(a/2):s(e/(o/2)):l>t&&(r?g(t-a/2):s((t-e)/(o/2))),T()}function E(e){const t=y(),n=d(),o=a(n),i=p();e<0?e=0:e>t&&(e=t),f.scaleCentreY=e;const r=e+o/2;e-o/2<0?i?m(o/2):s(e):r>t&&(i?m(t-o/2):s(t-e)),T(),f.scaleCentreY=v()}function x(e){const t=y(),n=C();let r=e;a(e)>t&&(r=t/2),i(r)>n&&(r=n/o),r!==e&&s(r);const l=u(),c=i(r);l+c/2>n?g(n-c/2):l-c/2<0&&g(c/2);const d=v(),p=a(r);d+p/2>t?m(t-p/2):d-p/2<0&&m(p/2),T()}function T(){const e=l.image.outputCanvas;0===d()?function(e){h(e),e.globalCompositeOperation="destination-out",e.clearRect(0,0,e.canvas.width,e.canvas.height)}(e):(function(e){h(e),e.drawImage(l.image.hiddenImage,0,0)}(e),function(e){const t=d(),n=u(),o=v(),r=i(t),l=a(t),c=o-l/2,s=o+l/2,g=n+r/2,m=n-r/2;h(e),e.globalCompositeOperation="destination-out";const p=Math.max(c-1,0),f=Math.min(s+1,e.canvas.height),y=f-p,C=Math.max(m-1,0),b=Math.min(g+1,e.canvas.width);c>0&&e.fillRect(0,0,e.canvas.width,c);s<e.canvas.height&&e.fillRect(0,s,e.canvas.width,e.canvas.height-s);m>0&&e.fillRect(0,p,m,y);g<e.canvas.width&&e.fillRect(g,p,e.canvas.width-g,y);e.beginPath(),e.moveTo(C,p),e.lineTo(C,c+.5*t+1),e.lineTo(m,c+.5*t),e.lineTo(n,c),e.lineTo(g,c+.5*t),e.lineTo(b,c+.5*t+1),e.lineTo(b,p),e.closePath(),e.fill(),e.beginPath(),e.moveTo(C,f),e.lineTo(C,s-.5*t-1),e.lineTo(m,s-.5*t),e.lineTo(n,s),e.lineTo(g,s-.5*t),e.lineTo(b,s-.5*t-1),e.lineTo(b,f),e.closePath(),e.fill()}(e))}function I(e){void 0!==l.image.hiddenImage&&document.body.removeChild(oldImg);const t=document.createElement("img");t.id="hiddenImage",t.origin="anonymous",t.src=URL.createObjectURL(e),t.style="position:absolute; top: -9999px; left: -9999px;",t.onload=function(){r.image.hiddenImage=document.getElementById("hiddenImage");const e=l.image.outputCanvas,t=l.image.backgroundCanvas;e.canvas.width=t.canvas.width=this.naturalWidth,e.canvas.height=t.canvas.height=this.naturalHeight,h(t),t.globalAlpha=.3,t.drawImage(l.image.hiddenImage,0,0),function(e){const t=e.canvas.width/o,n=e.canvas.height/2,a=Math.min(t,n,80),i=e.canvas.width/2,r=e.canvas.height/2;f.scaleCentreX=i,f.scaleCentreY=r,s(a),g(i),m(r)}(e),T()},document.body.appendChild(t)}window.onload=()=>{(()=>{const e=document.getElementById("background");r.image.background=e,r.image.backgroundCanvas=e.getContext("2d")})(),(()=>{const e=document.getElementById("output");r.image.output=e,r.image.outputCanvas=e.getContext("2d")})(),r.control.xCentre=document.getElementById("x"),r.control.yCentre=document.getElementById("y"),r.control.edge=document.getElementById("edge"),r.control.fileSelector=document.getElementById("fileSelector"),r.control.exportButton=document.getElementById("export"),r.control.edgeLocked=document.getElementById("edgeLocked"),l.image.output.addEventListener("mousemove",({clientX:e,clientY:t})=>{const{left:n,top:o}=l.image.output.getBoundingClientRect(),a=e-n,i=t-o;T(),k(l.image.outputCanvas,a,i)}),l.image.output.addEventListener("click",({clientX:e,clientY:t})=>{const{left:n,top:o}=l.image.output.getBoundingClientRect(),a=e-n,i=t-o;f.scaleCentreX=a,f.scaleCentreY=i;const{x:r,y:c}=w(a,i,d(),C(),y());g(r),m(c),T(),k(l.image.outputCanvas,a,i)}),l.image.output.addEventListener("mouseleave",()=>{T()}),l.image.output.addEventListener("wheel",e=>{if(e.preventDefault(),p())return;let t=d()+.5*e.deltaY;t<0&&(t=0),g(f.scaleCentreX),b(f.scaleCentreX),m(f.scaleCentreY),E(f.scaleCentreY),s(t),x(t)});const e=document.getElementById("dropzone");window.addEventListener("dragenter",(function(t){e.style.visibility="visible"}));e.addEventListener("dragenter",e=>{e.dataTransfer.dropEffect="move",e.preventDefault()}),e.addEventListener("dragover",e=>{e.dataTransfer.dropEffect="move",e.preventDefault()}),e.addEventListener("drop",t=>{t.preventDefault(),t.stopPropagation(),e.style.visibility="hidden",I(t.dataTransfer.files[0])}),e.addEventListener("dragleave",t=>{e.style.visibility="hidden"}),l.control.xCentre.addEventListener("change",e=>b(parseFloat(l.control.xCentre.value))),l.control.yCentre.addEventListener("change",e=>E(parseFloat(l.control.yCentre.value))),l.control.edge.addEventListener("change",e=>x(parseFloat(l.control.edge.value))),l.control.fileSelector.addEventListener("change",e=>function(e){if(void 0===e)return;I(e)}(e.target.files[0])),l.control.exportButton.addEventListener("click",e=>function(e){const t=d();if(0===t)return void alert("hex too small");const n=i(t),o=a(t),r=document.createElement("canvas");r.width=n,r.height=o;const l=u(),c=v(),s=l-n/2,g=c-o/2;r.getContext("2d").drawImage(document.getElementById("output"),s,g,n,o,0,0,n,o),e.href=r.toDataURL("image/png")}(l.control.export))};const w=(e,t,n,o,a)=>({x:L(e,n,o),y:B(t,n,a)}),L=(e,t,n)=>{const o=i(t);return e+o/2>n?n-o/2:e-o/2<0?o/2:e},B=(e,t,n)=>{const o=a(t);return e+o/2>n?n-o/2:e-o/2<0?o/2:e};function k(e,t,n){const o=d(),r=y(),l=C(),c=i(o)/2,s=a(o)/2,u=s/2,{x:g,y:v}=w(t,n,o,l,r);h(e),e.beginPath(),e.moveTo(g-c,v-u),e.lineTo(g-c,v+u),e.lineTo(g,v+s),e.lineTo(g+c,v+u),e.lineTo(g+c,v-u),e.lineTo(g,v-s),e.closePath(),e.stroke()}}]);
//# sourceMappingURL=bundle.js.map